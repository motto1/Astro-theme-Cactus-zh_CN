---
import { type CollectionEntry, getCollection } from "astro:content";
// import SocialList from "@/components/SocialList.astro";
import PostPreview from "@/components/blog/PostPreview.astro";
import Note from "@/components/note/Note.astro";
import { getAllPosts } from "@/data/post";
import PageLayout from "@/layouts/Base.astro";
import { collectionDateSort } from "@/utils/date";
export const prerender = true;

// Posts
const MAX_POSTS = 10;
const allPosts = await getAllPosts();
const allPostsByDate = allPosts
	.sort(collectionDateSort)
	.slice(0, MAX_POSTS) as CollectionEntry<"post">[];

// Notes
const MAX_NOTES = 0;
const allNotes = await getCollection("note");
const latestNotes = allNotes.sort(collectionDateSort).slice(0, MAX_NOTES);
---

<!-- 修改：现代化主页设计 -->
<PageLayout meta={{ title: "主页" }}>
	<!-- Hero Section -->
	<section class="modern-section mb-12 fade-in-up">
		<div class="text-center">
			<h1 class="text-4xl font-bold mb-4 bg-gradient-to-r from-blue-600 via-purple-600 to-blue-800 bg-clip-text text-transparent">
				欢迎来到 Motto 的数字世界 🌍
			</h1>
			<p class="text-lg text-gray-600 dark:text-gray-300 max-w-2xl mx-auto leading-relaxed">
				在这里，我分享技术洞察、创意思考和生活感悟。与我一同探索数字时代的无限可能。
			</p>
		</div>
	</section>
	
	<!-- 最近文章区域 -->
	<section class="modern-section fade-in-up" aria-label="Blog post list" style="animation-delay: 0.2s;">
		<h2 class="modern-title">
			<a href="/" class="hover:opacity-80 smooth-transition">📝 最近文章</a>
		</h2>
		<div class="space-y-4">
			{
				allPostsByDate.map((p) => (
					<div class="glass-card p-6 smooth-transition">
						<PostPreview post={p} withDesc={true} />
					</div>
				))
			}
		</div>
		<div class="mt-8 text-center">
			<a 
				class="inline-flex items-center px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white font-semibold rounded-full hover:from-blue-600 hover:to-purple-700 smooth-transition shadow-lg hover:shadow-xl transform hover:scale-105" 
				href="/posts/"
			>
				🔍 查看更多文章
			</a>
		</div>
	</section>
	{
		latestNotes.length > 0 && (
			<section class="mt-16">
				<h2 class="title mb-6 text-xl text-accent">
					<a href="/notes/">笔记</a>
				</h2>
				<ul class="space-y-4" role="list">
					{latestNotes.map((note) => (
						<li>
							<Note note={note} as="h3" isPreview />
						</li>
					))}
				</ul>
			</section>
		)
	}
</PageLayout>
